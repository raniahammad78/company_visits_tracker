<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Email template for sending visit reports -->
        <record id="email_template_visit_report" model="mail.template">
            <field name="name">Visit Report - Send by Email</field>
            <field name="model_id" ref="company_visit_tracker.model_company_visit"/>
            <field name="subject">Visit Report: ${object.name} for ${object.partner_id.name}</field>
            <field name="email_from">"${object.company_id.name}" &lt;${object.company_id.email or user.email}&gt;</field>
            <field name="email_to">${object.partner_id.email}</field>

            <field name="report_template_ids" eval="[(6, 0, [ref('company_visit_tracker.action_report_company_visit')])]"/>

            <!-- FIXED: Remove lang field to avoid language code errors -->
            <!-- Language will be automatically determined by Odoo -->

            <field name="auto_delete" eval="True"/>
            <field name="body_html"><![CDATA[
<div style="font-family: Arial, sans-serif; font-size: 14px; max-width: 600px; margin: 0 auto; padding: 20px;">
    <!-- Header with company logo -->
    <div style="text-align: center; margin-bottom: 30px; border-bottom: 2px solid #0051b6; padding-bottom: 20px;">
        <h2 style="color: #0051b6; margin: 0;">SERVICE CALL REPORT</h2>
    </div>

    <p>Dear <strong>${object.partner_id.name}</strong>,</p>

    <p>Please find attached the service visit report for your recent service call.</p>

    <!-- Visit Details Table -->
    <table style="width: 100%; border-collapse: collapse; margin: 20px 0; border: 1px solid #dee2e6;">
        <tr style="background-color: #f8f9fa;">
            <td style="padding: 10px; border: 1px solid #dee2e6; font-weight: bold;">Visit Number:</td>
            <td style="padding: 10px; border: 1px solid #dee2e6;">${object.name}</td>
        </tr>
        <tr>
            <td style="padding: 10px; border: 1px solid #dee2e6; font-weight: bold;">Visit Date:</td>
            <td style="padding: 10px; border: 1px solid #dee2e6;">${object.visit_date}</td>
        </tr>
        <tr style="background-color: #f8f9fa;">
            <td style="padding: 10px; border: 1px solid #dee2e6; font-weight: bold;">Assigned Engineer:</td>
            <td style="padding: 10px; border: 1px solid #dee2e6;">${object.assign_engineer_id.name}</td>
        </tr>
        <tr>
            <td style="padding: 10px; border: 1px solid #dee2e6; font-weight: bold;">Type of Problem:</td>
            <td style="padding: 10px; border: 1px solid #dee2e6;">${object.reason}</td>
        </tr>
    </table>

    <p>
        <strong>Services Performed:</strong><br/>
        <div style="background-color: #f8f9fa; padding: 15px; border-left: 4px solid #0051b6; margin: 10px 0;">
            ${object.description or 'No additional comments'}
        </div>
    </p>

    <p>Could you please review the attached report and provide your signature at your earliest convenience?</p>

    <p>If you have any questions or concerns about the services provided, please do not hesitate to contact us.</p>

    <div style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #dee2e6;">
        <p>Best regards,</p>
        <p>
            <strong>${object.company_id.name}</strong><br/>
            % if object.company_id.phone:
            Phone: ${object.company_id.phone}<br/>
            % endif
            % if object.company_id.email:
            Email: ${object.company_id.email}
            % endif
        </p>
    </div>

    <div style="text-align: center; margin-top: 30px; padding: 15px; background-color: #f8f9fa; color: #666; font-size: 12px;">
        This is an automated email. Please do not reply directly to this message.
    </div>
</div>
            ]]></field>
        </record>
    </data>
</odoo>